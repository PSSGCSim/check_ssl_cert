Added sanity checks for file write operations

